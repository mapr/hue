#!/bin/sh

. "${MAPR_HOME}/conf/env.sh"

# Add path to libjvm.so into LD_LIBRARY_PATH
# Find JRE directory using MapR env.sh script
if [ -e "${JAVA_HOME}/jre/lib/amd64/server" ]; then
    # java_directory points to JDK
    libjvm_path="${JAVA_HOME}/jre/lib/amd64/server"
elif [ -e "${JAVA_HOME}/lib/amd64/server" ]; then
    # java_directory points to JRE (MapR env.sh can return JAVA_HOME pointing to JRE_HOME)
    libjvm_path="${JAVA_HOME}/lib/amd64/server"
fi
export LD_LIBRARY_PATH="${MAPR_HOME}/lib:${HUE_HOME}/build/env/lib:${libjvm_path}:${LD_LIBRARY_PATH}"

# Explicitly set location of cyrus-sasl libraries when we package them
if [ -d "${HUE_HOME}/build/env/lib/sasl2" ]; then
    export SASL_PATH="${HUE_HOME}/build/env/lib/sasl2"
fi

# Add /opt/mapr/libexp/maprsecurity.so into PYTHONPATH
export PYTHONPATH="${MAPR_HOME}/libexp:${PYTHONPATH}"

# MEP-28 Adapt all ecosystems to use the runtime library from /opt/mapr/lib.
# Simba Drill JDBC driver needs to get hadoop-auth, hadoop-common and maprfs jars.
export CLASSPATH=$(mapr classpath)

# Fix cryptography-2.9 issues with OpenSSL 1.0.1 on Ubuntu 14.04
if [ -e /etc/debian_version ]; then
    export CRYPTOGRAPHY_ALLOW_OPENSSL_101=true
fi
