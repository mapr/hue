/*!
 * routie - a tiny hash router
 * v0.3.0
 * https://github.com/jgallen23/routie
 * copyright JGA 2012
 * MIT License
 */
(function(e){var t=[];var n={};var r="routie";var i=e[r];var s=function(e,t){this.name=t;this.path=e;this.keys=[];this.fns=[];this.params={};this.regex=o(this.path,this.keys,false,false)};s.prototype.addHandler=function(e){this.fns.push(e)};s.prototype.removeHandler=function(e){for(var t=0,n=this.fns.length;t<n;t++){var r=this.fns[t];if(e==r){this.fns.splice(t,1);return}}};s.prototype.run=function(e){for(var t=0,n=this.fns.length;t<n;t++){this.fns[t].apply(this,e)}};s.prototype.match=function(e,t){var n=this.regex.exec(e);if(!n)return false;for(var r=1,i=n.length;r<i;++r){var s=this.keys[r-1];var o="string"==typeof n[r]?decodeURIComponent(n[r]):n[r];if(s){this.params[s.name]=o}t.push(o)}return true};s.prototype.toURL=function(e){var t=this.path;for(var n in e){t=t.replace("/:"+n,"/"+e[n])}t=t.replace(/\/:.*\?/g,"/").replace(/\?/g,"");if(t.indexOf(":")!=-1){throw new Error("missing parameters for url: "+t)}return t};var o=function(e,t,n,r){if(e instanceof RegExp)return e;if(e instanceof Array)e="("+e.join("|")+")";e=e.concat(r?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(e,n,r,i,s,o){t.push({name:i,optional:!!o});n=n||"";return""+(o?"":n)+"(?:"+(o?n:"")+(r||"")+(s||r&&"([^/.]+?)"||"([^/]+?)")+")"+(o||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)");return new RegExp("^"+e+"$",n?"":"i")};var u=function(e,r){var i=e.split(" ");var o=i.length==2?i[0]:null;e=i.length==2?i[1]:i[0];if(!n[e]){n[e]=new s(e,o);t.push(n[e])}n[e].addHandler(r)};var a=function(e,t){if(typeof t=="function"){u(e,t);a.reload()}else if(typeof e=="object"){for(var n in e){u(n,e[n])}a.reload()}else if(typeof t==="undefined"){a.navigate(e)}};a.lookup=function(e,n){for(var r=0,i=t.length;r<i;r++){var s=t[r];if(s.name==e){return s.toURL(n)}}};a.remove=function(e,t){var r=n[e];if(!r)return;r.removeHandler(t)};a.removeAll=function(){n={};t=[]};a.navigate=function(e,t){t=t||{};var n=t.silent||false;if(n){p()}setTimeout(function(){window.location.hash=e;if(n){setTimeout(function(){h()},1)}},1)};a.noConflict=function(){e[r]=i;return a};var f=function(){tmp=window.location.hash.substring(1);if(navigator.userAgent.indexOf("Firefox")!==-1){arr=tmp.split("/");if(arr.length<3){return tmp}if(arr.length>1){tmp=arr[0]+"/";for(var e=1;e<arr.length;e++){if(arr[e].length>0){tmp+="%2F"+arr[e]}}}}return tmp};var l=function(e,t){var n=[];if(t.match(e,n)){t.run(n);return true}return false};var c=a.reload=function(){var e=f();for(var n=0,r=t.length;n<r;n++){var i=t[n];if(l(e,i)){return}}};var h=function(){if(e.addEventListener){e.addEventListener("hashchange",c,false)}else{e.attachEvent("onhashchange",c)}};var p=function(){if(e.removeEventListener){e.removeEventListener("hashchange",c)}else{e.detachEvent("onhashchange",c)}};h();e[r]=a})(window)